---
date: '2024-05-13 03:16'
updateTime: '2024-05-15T02:17:00.000Z'
sort: ''
catalog: []
status: 已发布
insertTime: '2024-05-13T03:16:00.000Z'
recommend: ''
_updated: ''
excerpt: 为了方便，为了好看，继续了哪吒面板的终极进化之路：VPS橱窗。我觉得可以叫做VPS小商城了，貌似该有的都有了，没有的以后可能还会有。。
summary: ''
_date: ''
tags:
  - 哪吒
  - 哪吒面板
  - VPS
  - 主题美化
  - 美化
  - 剩余价值
updated: '2024-05-15 02:17'
cover: ''
categories:
  - 燕坊清作
abbrlink: 2665
urlname: 2024-05-13-哪吒面板终极进化之VPS橱窗
title: 哪吒面板终极进化之VPS橱窗
---

## 简介


为了方便，为了好看，继续了哪吒面板的终极进化之路：`VPS橱窗`。我觉得可以叫做`VPS小商城`了，貌似该有的都有了，没有的以后可能还会有。。


## 步骤

- 在`哪吒面板`、`设置界面`、`自定义代码（包括 style 和 script）`中添加下面这段`js`代码；
- 刷新即可看到效果
- [演示](https://nezha.887776.xyz/)，哪吒版本：`0.16.22`

## 特性

- 支持购买同款按钮
- 分组支持数量显示
- 支持价格、付款周期展示
- 支持多种联系方式展示
- 支持到期日期进度条展示
- 支持`剩余价值`展示，支持`年付`、`半年付`、`季付`、`月付`，参考下面特殊说明`cycle`字段，仅供参考，计算方式取自[@sunfei](https://www.nodeseek.com/post-20207-1)大佬的帖子，感谢分享。

## 特殊说明

- 不限定所属分类，需要为每个小鸡指定`shop`字段，其值对应`affLinks`中的`key`
- `affLinks`中填写不同商家的邀请链接地址
- `extraData`中的数字`key`要换成自己机器的`id`号
- `extraData`中的购买价格`price`支持单位：`$、￥、P、€`
- `extraData`中的付款周期`cycle`支持填写：`年付、半年付、季付、月付、年、半、季、月、Year、Half、Quarterly、Month、Y、H、Q、M、year、half、quarterly、month`
- `contacts`中填写你需要的联系方式
- `contacts`中`main`标识需要显示在购买同款按钮旁边的联系方式
- `contacts`中`animatedType`标识`剩余价值`的动画方式，留空为`横向移动`，可选值为：`vertical`、`fade`。参考地址：[https://semantic-ui.com/elements/button.html#animated](https://semantic-ui.com/elements/button.html#animated)
- `contacts`中的`icon`图标在这里查找：[https://semantic-ui.com/elements/icon.html](https://semantic-ui.com/elements/icon.html)
- 其它效果大家可自行发挥

```javascript
<script>
window.onload = function(){
  const affLinks = {
    crunchbits: 'https://get.crunchbits.com/order/lblk-yearly-kvm-ssd-vps/84',
    rainyun: 'https://www.rainyun.com/MjYzMTk=_',
    colocrossing: 'https://cloud.colocrossing.com/aff.php?aff=316',
    racknerd: 'https://my.racknerd.com/aff.php?aff=9727',
}
const contacts = {
  main: 'telegram',
  animatedType: 'vertical',
  telegram: {
    label: 'TG',
    icon: 'telegram plane',
    url: 'https://t.me/bmqyChatBot'
  },
  qq: {
    label: 'QQ',
    icon: 'qq',
    url: 'https://wpa.qq.com/msgrd?V=1&Uin=88268459&Site=https://nezha.887776.xyz/&Menu=yes'
  },
  email: {
    label: 'Email',
    icon: 'mail',
    url: 'mailto:notice@bmqy.net'
  },
}
const extraData = {
  2: {
    pid: 0,
    shop: 'crunchbits',
    price: '$27.38',
    cycle: 'Year',
    start: '08/13/2023',
    expire: '08/13/2024'
  },
  15: {
    pid: 0,
    shop: 'crunchbits',
    price: '$22.69',
    cycle: 'Year',
    start: '04/08/2024',
    expire: '04/08/2025'
  },
  10: {
    pid: 358,
    shop: 'racknerd',
    price: '$10.98',
    cycle: 'Year',
    start: '11/14/2023',
    expire: '11/14/2024'
  },
  12: {
    pid: 23,
    shop: 'colocrossing',
    price: '$10.00',
    cycle: 'Year',
    start: '02/13/2024',
    expire: '02/13/2025'
  },
  13: {
    pid: 0,
    shop: 'rainyun',
    price: '￥245',
    cycle: 'Year',
    start: '07/03/2023',
    expire: '08/09/2024'
  },
  14: {
    pid: 0,
    shop: 'rainyun',
    price: 'P1500',
    cycle: 'Week',
    start: '12/27/2023',
    expire: '∞'
  },
}
const cats = document.querySelectorAll('.ui.accordion');
cats.forEach((e, i)=>{
  let $catsTitle = e.querySelector('.title');
  let ct = $catsTitle.innerText;
  ct = ct.trim();	
  
  let $itemCard = e.querySelectorAll('.ui.card');
  let uiCardCount = $itemCard.length;
  $catsTitle.innerHTML = $catsTitle.innerHTML.replace(ct, ct+ ' ('+ uiCardCount +')');
  $itemCard.forEach((ee, ii)=>{
    let $content = ee.querySelector('.content');
    let $descriptionGrid = ee.querySelector('.description .ui.grid');
    let $itemTitle = $content.querySelector('.header');
    let id = ee.getAttribute('id');
    if(extraData[id]){
      let pid = extraData[id].pid;
      pid = parseInt(pid);
      let shop = extraData[id].shop;
      let price = extraData[id].price;
      let start = extraData[id].start;
      let expire = extraData[id].expire;
      let cycle = extraData[id].cycle;
      let nowTime = parseInt(new Date().getTime() / 1000);
      let beginTime = parseInt(new Date(start).getTime() / 1000);
      let endTime = parseInt(new Date(expire).getTime() / 1000);
      let $aButtonsBox = document.createElement('div');
      $aButtonsBox.setAttribute('style', 'margin-bottom: .5em;text-align:right;');
      let $aLinkButtons = document.createElement('div');
      $aLinkButtons.setAttribute('class', 'ui buttons mini');
      let $aLinkBuy = document.createElement('a');
      $aLinkBuy.setAttribute('class', 'ui button positive');
      $aLinkBuy.setAttribute('target', '_blank');
      $aLinkBuy.innerHTML = '购买同款';
      $aLinkBuy.href = affLinks[shop];
      if(pid){
        $aLinkBuy.href += '&pid='+ pid;
      }
      if(price){
        let $priceL = document.createElement('div');
        $priceL.setAttribute('class', 'three wide column');
        $priceL.innerHTML = '价格';
        $descriptionGrid.insertBefore($priceL, $descriptionGrid.childNodes[$descriptionGrid.childNodes.length-3]);
        let $priceR = document.createElement('div');
        $priceR.setAttribute('class', 'thirteen wide column');
        $priceR.innerHTML = '<div class="ui red label"><i class="money bill alternate yellow icon"></i>'+ price +'<a class="detail">'+ cycle +'</a></div>';
        $descriptionGrid.insertBefore($priceR, $descriptionGrid.childNodes[$descriptionGrid.childNodes.length-3])
      }
      if(expire){
        let $expireL = document.createElement('div');
        $expireL.setAttribute('class', 'three wide column');
        $expireL.innerHTML = '到期';
        $descriptionGrid.insertBefore($expireL, $descriptionGrid.childNodes[$descriptionGrid.childNodes.length-3])
        let $expireR = document.createElement('div');
        let aTime = (nowTime-beginTime);
        let bTime = (endTime-beginTime);
        let cTime = parseInt(aTime / bTime * 100);
        let progressType = 'error';
        let textStyle = 'text-shadow: 0px 0px 5px #db2828;';
        if(expire === '∞'){
          progressType = 'success';
          textStyle = '';
        }
        $expireR.setAttribute('class', 'thirteen wide column');
        $expireR.innerHTML = '<div class="ui progress '+ progressType +'"><div class="bar" style="transition-duration: 300ms; min-width: unset; background-color: orange; width: '+ cTime +'% !important;padding-left: 0.4em;"><small style="'+ textStyle +'">'+ expire +'</small></div></div>';
        $descriptionGrid.insertBefore($expireR, $descriptionGrid.childNodes[$descriptionGrid.childNodes.length-3])
      }
      $aLinkButtons.append($aLinkBuy);
      let $aLinkOr = document.createElement('div');
      $aLinkOr.innerHTML = '<div class="or" data-text="or"></div>';
      $aLinkButtons.append($aLinkOr);
      let cycleNames = {
        '年付': 'year',
        '半年付': 'half',
        '季付': 'quarterly',
        '月付': 'month',
        '年': 'year',
        '半': 'half',
        '季': 'quarterly',
        '月': 'month',
        'Year': 'year',
        'Half': 'half',
        'Quarterly': 'quarterly',
        'Month': 'month',
        'Y': 'year',
        'H': 'half',
        'Q': 'quarterly',
        'M': 'month',
        'year': 'year',
        'half': 'half',
        'quarterly': 'quarterly',
        'month': 'month',
      }
      let cycleValues = {
        year: 365,
        half: 180,
        quarterly: 90,
        month: 30,
      }
      let remainingAnimatedType = contacts['animatedType'];
      let priceValue = price.replace(/[$￥P€]/g, '');
      let priceUnit = price.match(/[$￥P€]/g)[0];
      let cycleName = cycleNames[cycle];
      let cycleValue = cycleValues[cycleName];
      let remainingDays = Math.floor((endTime - nowTime) / (24 * 60 * 60));
      let remainingPrice = parseFloat(priceValue) / cycleValue  * remainingDays;
      if(!remainingPrice){
        remainingPrice = 0;
      }
      remainingPrice = remainingPrice.toFixed(2);
      let mainContact = contacts['main'];
      let $aLinkContactMain = document.createElement('a');
      $aLinkContactMain.setAttribute('class', 'ui button '+ remainingAnimatedType +' animated blue');
      $aLinkContactMain.setAttribute('target', '_blank');
      $aLinkContactMain.innerHTML = '<div class="hidden content" style="padding:0;" title="剩余价值">'+ contacts[mainContact].label +'议价</div><div class="visible content" style="padding:0;" title="剩余价值"><i class="'+ contacts[mainContact].icon +' icon" style="color:white;"></i>'+ priceUnit + remainingPrice +'</div>';
      $aLinkContactMain.href = contacts[mainContact].url;
      $aLinkButtons.append($aLinkContactMain);
      $aButtonsBox.append($aLinkButtons);
      for(let key in contacts){
        if(key!='main' && key!='animatedType' && key!=contacts['main']){
          let icon = contacts[key].icon;
          let $aLinkContact = document.createElement('a');
          $aLinkContact.setAttribute('class', 'ui circular '+ icon +' mini icon button');
          $aLinkContact.setAttribute('target', '_blank');
          $aLinkContact.setAttribute('style', 'margin-left:.5em;');
          $aLinkContact.innerHTML = '<i class="'+ icon +' icon"></i>';
          $aLinkContact.href = contacts[key].url;
          $aButtonsBox.append($aLinkContact);
        }
      }
      $content.append($aButtonsBox);
      
    }
  });
});
}
</script>
```


## 效果图


![QQ%E6%88%AA%E5%9B%BE20240515101659.png](https://image.bmqy.net/upload/a2a832682c4c535ff31c46f883a8d083.png)


![WX20240508-233030@2x.png](https://image.bmqy.net/upload/46adec9c6a9d7752a53ddd3d9309639a.png)

